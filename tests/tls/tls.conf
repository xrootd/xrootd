[ ca ]
default_ca             = xrootd_ca

[ req ]
prompt                 = no
default_bits           = 4096
string_mask            = utf8only
distinguished_name     = xrootd_ca_dn
req_extensions         = xrootd_req_ext

[ xrootd_ca ]
dir                    = @CMAKE_CURRENT_BINARY_DIR@
private_key            = $dir/ca.key
certificate            = $dir/ca.pem
new_certs_dir          = $dir/ca
serial                 = $dir/ca/serial
crl_number             = $dir/ca/serial-crl
database               = $dir/ca/db
rand_serial            = yes
policy                 = xrootd_ca_pol
x509_extensions        = xrootd_ca_ext
crl_extensions         = xrootd_crl_ext
default_md             = sha256
default_days           = 30
default_crl_days       = 7
copy_extensions        = none
name_opt               = ca_default
cert_opt               = ca_default

[ xrootd_ca_pol ]
commonName             = supplied
countryName            = optional
emailAddress           = optional
organizationName       = optional
organizationalUnitName = optional
stateOrProvinceName    = optional

[ xrootd_ca_dn ]
O                      = XRootD
CN                     = XRootD Root CA

[ xrootd_ca_ext ]
keyUsage               = critical,keyCertSign,cRLSign
basicConstraints       = critical,CA:true,pathlen:0
authorityKeyIdentifier = keyid,issuer
subjectKeyIdentifier   = hash

[ xrootd_crl_ext ]
authorityKeyIdentifier = keyid,issuer

[ xrootd_req_ext ]
keyUsage               = critical,keyCertSign,cRLSign
basicConstraints       = critical,CA:true
subjectKeyIdentifier   = hash

[ xrootd_crt_ext ]
keyUsage               = digitalSignature,keyEncipherment
extendedKeyUsage       = critical,clientAuth,serverAuth
basicConstraints       = critical,CA:false
subjectAltName         = @xrootd_san_ext

[ xrootd_usr_ext ]
keyUsage               = digitalSignature,keyEncipherment
extendedKeyUsage       = critical,clientAuth
basicConstraints       = critical,CA:false

[ xrootd_san_ext ]
DNS.1 = @HOSTNAME@
DNS.2 = localhost
IP.1  = 127.0.0.1
IP.2  = ::1
